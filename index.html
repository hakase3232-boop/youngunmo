<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¹´í˜ ë°”ë¡œê°€ê¸° ì„¤ì¹˜</title>

    <link rel="manifest" href="/youngunmo/manifest.json?v=3">
    <link rel="apple-touch-icon" href="/youngunmo/images/icon-192.png?v=3">
    <meta name="theme-color" content="#ffffff">

    <style>
        /* ì–´ë¥´ì‹ ë“¤ì„ ìœ„í•œ í° ê¸€ì”¨ ìŠ¤íƒ€ì¼ */
        body {
            font-size: 1.5rem; /* ì „ì²´ ê¸€ì”¨ í¬ê²Œ */
            font-family: 'Malgun Gothic', sans-serif;
            text-align: center;
            padding: 50px 20px;
            line-height: 1.6;
            background-color: #f5f5f5;
            color: #333;
        }

        /* í° ì´ˆë¡ìƒ‰ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .big-btn {
            font-size: 1.8rem;
            font-weight: bold;
            padding: 20px 40px;
            background-color: #03cf5d; /* ë„¤ì´ë²„ ì´ˆë¡ìƒ‰ */
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 400px;
            margin-top: 20px;
        }

        /* ì•„ì´í° ì „ìš© ì•ˆë‚´ì°½ (í™”ë©´ í•˜ë‹¨ì— ë–  ìˆìŒ) */
        #iphoneGuide {
            display: none;
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            background: white;
            border: 4px solid #03cf5d;
            border-radius: 20px;
            padding: 20px;
            z-index: 9999;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.3);
        }

        .highlight { color: #03cf5d; font-weight: bold; }
        .small-text { font-size: 1rem; color: #666; margin-top: 20px; }
    </style>
</head>
<body>

    <div id="main-content">
        <p>ì•„ë˜ ë²„íŠ¼ì„ ëˆŒëŸ¬ ì•±ì„ ì„¤ì¹˜í•´ì£¼ì„¸ìš”. ì´ë¯¸ ì„¤ì¹˜í•œê²½ìš° ìë™ìœ¼ë¡œ ì¹´í˜ë¡œ ì´ë™ë©ë‹ˆë‹¤.</p>
        
        <button id="installButton" class="big-btn" style="display: none;">
             ì˜ìš´ëª¨ ì•± ì„¤ì¹˜í•˜ê¸°
        </button>

        <div id="naverWorkaround" style="display: none;">
            <p>âš ï¸ ë„¤ì´ë²„ ì•±ì—ì„œëŠ”<br>ì„¤ì¹˜ê°€ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
            <button id="goToChrome" class="big-btn">
                ì—¬ê¸°ë¥¼ ëˆŒëŸ¬ì„œ ì„¤ì¹˜í•˜ê¸°
            </button>
            <p class="small-text">ìœ„ ë²„íŠ¼ì„ ëˆŒëŸ¬ì„œ ë¸Œë¼ìš°ì €ê°€ ì—´ë¦¬ë©´<br>[ì˜ìš´ëª¨ ì•± ì„¤ì¹˜í•˜ê¸°] ë²„íŠ¼ì„ ë‹¤ì‹œ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
        </div>

        <div id="iphoneGuide">
            <p>ğŸ <b style="font-size: 1.8rem;">ì•„ì´í° ì„¤ì¹˜ë°©ë²•</b></p>
            <p>1. ë§¨ ì•„ë˜ <b style="font-size: 2rem;">[ â†‘ ]</b> ë²„íŠ¼ í´ë¦­<br>
            2. <b class="highlight">'í™ˆ í™”ë©´ì— ì¶”ê°€'</b> í´ë¦­!</p>
            <div style="width: 0; height: 0; border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 15px solid #03cf5d; margin: 10px auto -30px;"></div>
        </div>
    </div>

    <script>
        // ğŸš¨ ë³¸ì¸ì˜ ì •ë³´ë¡œ ìˆ˜ì •í•˜ì„¸ìš”!
        const CAFE_URL = "https://cafe.naver.com/truckerking"; // ì‹¤ì œ ì¹´í˜ ì£¼ì†Œ
        const MY_URL = "hakase3232-boop.github.io/youngunmo/"; // ê¹ƒí—ˆë¸Œ ì£¼ì†Œ (http:// ë¹¼ê³ )

        let deferredPrompt;
        const userAgent = navigator.userAgent.toLowerCase();
        const isStandalone = window.matchMedia('(display-mode: standalone)').matches;
        const isNaverApp = userAgent.indexOf('naver') !== -1;
        const isIos = /iphone|ipad|ipod/.test(userAgent);

        // [í•µì‹¬] ì´ë¯¸ ì„¤ì¹˜í•´ì„œ ì•±ìœ¼ë¡œ ë“¤ì–´ì™”ë‹¤ë©´ ì¦‰ì‹œ ì¹´í˜ë¡œ ì´ë™
        if (isStandalone) {
            window.location.replace(CAFE_URL);
        }

        // 1. ë„¤ì´ë²„ ì•±ì¸ ê²½ìš° (ì•ˆë“œë¡œì´ë“œ ê¸°ì¤€)
        if (isNaverApp && !isIos) {
            document.getElementById('naverWorkaround').style.display = 'block';
            document.getElementById('goToChrome').onclick = function() {
                location.href = "intent://" + MY_URL + "#Intent;scheme=https;package=com.android.chrome;end";
            };
        } 
        // 2. ì•„ì´í°ì¸ ê²½ìš°
        else if (isIos && !isStandalone) {
            document.getElementById('iphoneGuide').style.display = 'block';
            // ì•„ì´í°ì€ ìë™ ì´ë™ì„ ì¡°ê¸ˆ ëŠ¦ì¶¤ (ì„¤ì¹˜í•  ì‹œê°„ì„ ì£¼ê¸° ìœ„í•´)
            setTimeout(() => { window.location.href = CAFE_URL; }, 8000);
        }
        // 3. ì¼ë°˜ ë¸Œë¼ìš°ì €(í¬ë¡¬ ë“±)ì¸ ê²½ìš°
        else {
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                const btn = document.getElementById('installButton');
                btn.style.display = 'block';

                btn.onclick = () => {
                    deferredPrompt.prompt();
                    deferredPrompt.userChoice.then((result) => {
                        if (result.outcome === 'accepted') btn.style.display = 'none';
                        deferredPrompt = null;
                    });
                };
            });

            // ì„¤ì¹˜ ì•ˆ í•  ì‚¬ëŒë“¤ì„ ìœ„í•´ 5ì´ˆ ë’¤ ì¹´í˜ ìë™ ì´ë™
            setTimeout(() => {
                if (!deferredPrompt) window.location.href = CAFE_URL;
            }, 5000);
        }

        // ì„œë¹„ìŠ¤ ì›Œì»¤ ë“±ë¡
      if ('serviceWorker' in navigator) {
    window.addEventListener('load', function() {
        navigator.serviceWorker.register('/youngunmo/service-worker.js').then(reg => {
            // ì—…ë°ì´íŠ¸ê°€ ìˆëŠ”ì§€ ì²´í¬
            reg.addEventListener('updatefound', () => {
                const newWorker = reg.installing;
                newWorker.addEventListener('statechange', () => {
                    if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                        // ìƒˆ ë²„ì „ì´ ì„¤ì¹˜ë˜ë©´ ì¦‰ì‹œ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ ë°˜ì˜
                        console.log('ìƒˆ ë²„ì „ ë°œê²¬! ì—…ë°ì´íŠ¸ë¥¼ ì§„í–‰í•©ë‹ˆë‹¤.');
                        location.reload();
                    }
                });
            });
        });
    });
}

// ì„œë¹„ìŠ¤ ì›Œì»¤ê°€ ë°”ë€Œì—ˆì„ ë•Œ ì œì–´ê¶Œì„ ê°€ì ¸ì˜¤ë©´ ìƒˆë¡œê³ ì¹¨
let refreshing = false;
navigator.serviceWorker.addEventListener('controllerchange', () => {
    if (!refreshing) {
        window.location.reload();
        refreshing = true;
    }
});
    </script>
</body>
</html>






