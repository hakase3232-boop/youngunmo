<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏòÅÏö¥Î™® Î∞îÎ°úÍ∞ÄÍ∏∞ ÏÑ§Ïπò</title>
    <style>
        body { font-size: 1.5rem; font-family: 'Malgun Gothic', sans-serif; text-align: center; padding: 50px 20px; line-height: 1.6; background-color: #f5f5f5; color: #333; }
        .big-btn { font-size: 1.8rem; font-weight: bold; padding: 20px 40px; color: white; border: none; border-radius: 15px; cursor: pointer; box-shadow: 0 10px 20px rgba(0,0,0,0.2); width: 100%; max-width: 400px; margin-top: 20px; }
        #androidSection button, #naverSection button { background-color: #03cf5d; }
        #iphoneSection button { background-color: #007aff; }
        .content-section { display: none; }
        #iphoneSection { background: white; border: 4px solid #007aff; border-radius: 20px; padding: 20px; margin-top: 20px; }
        .small-text { font-size: 1rem; color: #666; margin-top: 20px; }
    </style>
</head>
<body>

    <div id="iconData" style="display:none;">
        </div>
iVBORw0KGgoAAAANSUhEUgAAAMAAAADACAYAAABV7OTTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAB7JSURBVHja7Z15fBvVtf9/Z0Yja7clS7Ylb/Im3mInTuzYThonZCHpS0uhtEChL6X90vdbXp6H0vK09At96SstL6X0pS0U8pYmS9uSkhAnTuI43mI73m3JsiVrtpE0M+f3R9IsW7IlW7Y0M6P5vF+vfmXOzD1X9p25555z7rmXEEIgk8lYArIDZDIZAZDJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxGAJRJZARAmUxG
    <div id="main-content">
        <h2 style="font-size: 2.2rem; margin-bottom: 10px; color: #03cf5d;">ÏòÅÏö¥Î™® Ïπ¥Ìéò</h2>
        
        <div id="androidSection" class="content-section">
            <p>ÏïÑÎûò Î≤ÑÌäºÏùÑ ÎàåÎü¨ Ïï±ÏùÑ ÏÑ§ÏπòÌï¥Ï£ºÏÑ∏Ïöî.</p>
            <button id="installButton" class="big-btn">ÏòÅÏö¥Î™® Ïï± ÏÑ§ÏπòÌïòÍ∏∞</button>
        </div>

        <div id="naverSection" class="content-section">
            <p>‚ö†Ô∏è ÎÑ§Ïù¥Î≤Ñ Ïï±ÏóêÏÑúÎäî ÏÑ§ÏπòÍ∞Ä Ïïà Îê©ÎãàÎã§.</p>
            <button id="goToChrome" class="big-btn">Ïó¨Í∏∞Î•º ÎàåÎü¨ÏÑú ÏÑ§ÏπòÌïòÍ∏∞</button>
        </div>

        <div id="iphoneSection" class="content-section">
            <p>üçé <b>ÏïÑÏù¥Ìè∞ Ï†ÑÏö© ÏûêÎèôÏÑ§Ïπò</b></p>
            <button id="installProfile" class="big-btn">ÏïÑÏù¥Ìè∞ Î∞îÎ°úÍ∞ÄÍ∏∞ ÏÑ§ÏπòÌïòÍ∏∞</button>
            <p id="guideText" class="small-text" style="color:red; font-weight:bold;">
                [ÌóàÏö©] ÌÅ¥Î¶≠ ÌõÑ [ÏÑ§Ï†ï] Ïï± Îß® ÏúÑÏóêÏÑú<br>
                'Îã§Ïö¥Î°úÎìúÎêú ÌîÑÎ°úÌååÏùº'ÏùÑ ÎàåÎü¨ ÏÑ§ÏπòÌïòÏÑ∏Ïöî!
            </p>
        </div>
    </div>

    <script>
        const CAFE_URL = "https://cafe.naver.com/truckerking"; 

        // 1. Ï†ëÏÜç ÌôòÍ≤ΩÏóê Îî∞Î•∏ ÌôîÎ©¥ ÌëúÏãú Ï†úÏñ¥
        window.addEventListener('load', () => {
            const userAgent = navigator.userAgent.toLowerCase();
            const isIos = /iphone|ipad|ipod/.test(userAgent);
            const isNaverApp = userAgent.indexOf('naver') !== -1;
            const isStandalone = window.matchMedia('(display-mode: standalone)').matches;

            // Ïù¥ÎØ∏ Î∞îÎ°úÍ∞ÄÍ∏∞Î°ú Ï†ëÏÜçÌñàÎã§Î©¥ Î∞îÎ°ú Ïπ¥ÌéòÎ°ú Ïù¥Îèô
            if (isStandalone) {
                window.location.replace(CAFE_URL);
                return;
            }

            if (isIos) {
                document.getElementById('iphoneSection').style.display = 'block';
            } else if (isNaverApp) {
                document.getElementById('naverSection').style.display = 'block';
            } else {
                document.getElementById('androidSection').style.display = 'block';
            }
        });

        // 2. ÏïÑÏù¥Ìè∞Ïö© ÌîÑÎ°úÌååÏùº ÏÑ§Ïπò Î°úÏßÅ
        document.getElementById('installProfile').onclick = function() {
            // Ïà®Í≤®Îëî ÌÉúÍ∑∏ÏóêÏÑú Îç∞Ïù¥ÌÑ∞ Ï∂îÏ∂ú Î∞è Ï†ïÏ†ú
            const rawData = document.getElementById('iconData').textContent;
            const cleanBase64 = rawData.replace(/[^A-Za-z0-9+/=]/g, "");

            if (!cleanBase64) {
                alert("ÏïÑÏù¥ÏΩò Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§. ÏΩîÎìúÎ•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî.");
                return;
            }

            // UUID ÏÉùÏÑ±Í∏∞
            const genUUID = () => 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {
                const r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
                return v.toString(16);
            });

            const uuid1 = genUUID();
            const uuid2 = genUUID();

            const profileContent = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>PayloadContent</key>
    <array>
        <dict>
            <key>FullScreen</key><true/>
            <key>IsRemovable</key><true/>
            <key>Label</key><string>ÏòÅÏö¥Î™®</string>
            <key>PayloadDisplayName</key><string>ÏòÅÏö¥Î™®</string>
            <key>PayloadIdentifier</key><string>com.youngunmo.shortcut</string>
            <key>PayloadType</key><string>com.apple.webClip.managed</string>
            <key>PayloadUUID</key><string>${uuid1}</string>
            <key>PayloadVersion</key><integer>1</integer>
            <key>URL</key><string>${CAFE_URL}</string>
            <key>Icon</key><data>${cleanBase64}</data>
        </dict>
    </array>
    <key>PayloadDisplayName</key><string>ÏòÅÏö¥Î™® Î∞îÎ°úÍ∞ÄÍ∏∞ ÏÑ§Ïπò</string>
    <key>PayloadIdentifier</key><string>com.youngunmo.profile</string>
    <key>PayloadType</key><string>Configuration</string>
    <key>PayloadUUID</key><string>${uuid2}</string>
    <key>PayloadVersion</key><integer>1</integer>
</dict>
</plist>`;

            const blob = new Blob([profileContent], { type: 'application/x-apple-aspen-config' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'youngunmo.mobileconfig';
            document.body.appendChild(a);
            a.click();
            
            document.getElementById('guideText').innerHTML = "‚úÖ Îã§Ïö¥Î°úÎìú ÏôÑÎ£å!<br>ÏßÄÍ∏à Î∞îÎ°ú [ÏÑ§Ï†ï] Ïï±ÏúºÎ°ú Í∞ÄÏÑú ÏÑ§ÏπòÎ•º ÎßàÎ¨¥Î¶¨ÌïòÏÑ∏Ïöî!";

            setTimeout(() => {
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);
            }, 1000);
        };

        // 3. ÎÑ§Ïù¥Î≤Ñ Ïï± ÌÉàÏ∂ú (ÏïàÎìúÎ°úÏù¥Îìú Ï†ÑÏö©)
        document.getElementById('goToChrome').onclick = () => {
            location.href = "intent://" + location.host + location.pathname + "#Intent;scheme=https;package=com.android.chrome;end";
        };

        // 4. ÏïàÎìúÎ°úÏù¥Îìú PWA ÏÑ§Ïπò (ÌëúÏ§Ä Î∏åÎùºÏö∞Ï†Ä)
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
        });
        document.getElementById('installButton').onclick = () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
            } else {
                alert("ÌÅ¨Î°¨ Î∏åÎùºÏö∞Ï†ÄÏùò Î©îÎâ¥(‚ãÆ)ÏóêÏÑú 'Ïï± ÏÑ§Ïπò' ÎòêÎäî 'Ìôà ÌôîÎ©¥Ïóê Ï∂îÍ∞Ä'Î•º ÎàåÎü¨Ï£ºÏÑ∏Ïöî.");
            }
        };
    </script>
</body>
</html>
