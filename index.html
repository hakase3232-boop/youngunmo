<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì˜ìš´ëª¨ ì•± ì„¤ì¹˜</title>
    <style>
        body { font-family: -apple-system, sans-serif; text-align: center; padding: 20px; background-color: #f2f2f7; color: #333; }
        .container { max-width: 450px; margin: 0 auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); }
        h1 { color: #03cf5d; font-size: 1.8rem; margin-bottom: 5px; }
        .btn { display: block; width: 100%; padding: 18px; margin: 15px 0; font-size: 1.2rem; font-weight: bold; color: white; border: none; border-radius: 12px; cursor: pointer; text-decoration: none; }
        .btn-android { background-color: #03cf5d; }
        .btn-ios { background-color: #007aff; }
        .btn-naver { background-color: #1ec800; }
        .guide-box { background: #fff9db; border: 1px solid #fab005; border-radius: 12px; padding: 15px; text-align: left; font-size: 0.9rem; margin-top: 10px; }
        .hidden { display: none; }
    </style>
</head>
<body>

<div class="container">
    <h1>ì˜ìš´ëª¨ ì¹´í˜</h1>
    <p style="font-size: 1.1rem;">í™ˆ í™”ë©´ì— ë°”ë¡œê°€ê¸°ë¥¼ ì¶”ê°€í•˜ì„¸ìš”!</p>

    <div id="section-inapp" class="hidden">
        <p>âš ï¸ <b>ë„¤ì´ë²„ ì•±</b>ì—ì„œëŠ” ì„¤ì¹˜ê°€ ì•ˆ ë©ë‹ˆë‹¤.</p>
        <button class="btn btn-naver" onclick="exitInApp()">ê¸°ë³¸ ë¸Œë¼ìš°ì €(ì‚¬íŒŒë¦¬/í¬ë¡¬)ë¡œ ì—´ê¸°</button>
        <p style="font-size: 0.85rem; color: #666;">ìœ„ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì„¤ì¹˜ ê°€ëŠ¥í•œ ë¸Œë¼ìš°ì €ë¡œ ì´ë™í•©ë‹ˆë‹¤.</p>
    </div>

    <div id="section-android" class="hidden">
        <button id="btn-install-pwa" class="btn btn-android">ì•ˆë“œë¡œì´ë“œ ì•± ì„¤ì¹˜</button>
        <div class="guide-box">
            <b>ğŸ’¡ ì„¤ì¹˜ì°½ì´ ì•ˆ ëœ¨ëŠ” ê²½ìš° (ì‚¼ì„±í°)</b><br>
            í•˜ë‹¨ ë©”ë‰´ [â‰¡] â†’ [í˜„ì¬ í˜ì´ì§€ ì¶”ê°€] â†’ [í™ˆ í™”ë©´]ì„ ëˆ„ë¥´ì‹œë©´ ìˆ˜ë™ìœ¼ë¡œ ì„¤ì¹˜ë©ë‹ˆë‹¤.
        </div>
    </div>

    <div id="section-ios" class="hidden">
        <button class="btn btn-ios" onclick="installIosProfile()">ì•„ì´í° ë°”ë¡œê°€ê¸° ì„¤ì¹˜</button>
        <div class="guide-box">
            <b>ì„¤ì¹˜ ìˆœì„œ:</b><br>
            1. ë²„íŠ¼ í´ë¦­ í›„ 'í—ˆìš©' ì„ íƒ<br>
            2. <b>[ì„¤ì • ì•±]</b> ì‹¤í–‰<br>
            3. <b>[í”„ë¡œíŒŒì¼ ë‹¤ìš´ë¡œë“œë¨]</b> ë©”ë‰´ í´ë¦­<br>
            4. ìš°ì¸¡ ìƒë‹¨ <b>[ì„¤ì¹˜]</b> ì§„í–‰
        </div>
    </div>
</div>

<script>
    let deferredPrompt = null;
    window.addEventListener('beforeinstallprompt', (e) => { e.preventDefault(); deferredPrompt = e; });

    window.onload = function() {
        const ua = navigator.userAgent.toLowerCase();
        const isInApp = /naver|kakaotalk|line|cafe/.test(ua);
        const isIos = /iphone|ipad|ipod/.test(ua);

        if (isInApp) {
            document.getElementById('section-inapp').classList.remove('hidden');
        } else if (isIos) {
            document.getElementById('section-ios').classList.remove('hidden');
        } else {
            document.getElementById('section-android').classList.remove('hidden');
        }
    };

    function exitInApp() {
        // ì•„ì´í°ì€ ì‚¬íŒŒë¦¬, ì•ˆë“œë¡œì´ë“œëŠ” í¬ë¡¬/ì‚¼ì„±ìœ¼ë¡œ ê°•ì œ ì´ë™ ìœ ë„
        const url = window.location.href.replace(/^https?:\/\//, "");
        if (/iphone|ipad|ipod/.test(navigator.userAgent.toLowerCase())) {
            alert("ì‚¬íŒŒë¦¬(Safari) ë¸Œë¼ìš°ì €ë¡œ ì ‘ì†í•´ì£¼ì…”ì•¼ ì„¤ì¹˜ê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.\nì£¼ì†Œë¥¼ ë³µì‚¬í•´ì„œ ì‚¬íŒŒë¦¬ì— ë¶™ì—¬ë„£ì–´ì£¼ì„¸ìš”.");
        } else {
            location.href = "intent://" + url + "#Intent;scheme=https;end";
        }
    }

    document.getElementById('btn-install-pwa').onclick = async () => {
        if (deferredPrompt) {
            deferredPrompt.prompt();
        } else {
            alert("ì‚¼ì„± ì¸í„°ë„·ì€ í•˜ë‹¨ [â‰¡] ë©”ë‰´ë¥¼ í†µí•´ 'í˜„ì¬ í˜ì´ì§€ ì¶”ê°€' -> 'í™ˆ í™”ë©´'ìœ¼ë¡œ ì„¤ì¹˜í•´ì£¼ì„¸ìš”!");
        }
    };

    function installIosProfile() {
        const title = "ì˜ìš´ëª¨";
        const url = "https://cafe.naver.com/truckerking";
        // UUIDë¥¼ ê³ ì •í•˜ì§€ ì•Šê³  ì‹¤í–‰ ì‹œë§ˆë‹¤ ìƒì„±í•˜ì—¬ 'ìœ íš¨í•˜ì§€ ì•Šì€ í”„ë¡œí•„' ë°©ì§€
        const uuid1 = self.crypto.randomUUID();
        const uuid2 = self.crypto.randomUUID();

        const profile = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>PayloadContent</key>
	<array>
		<dict>
			<key>FullScreen</key>
			<true/>
			<key>IsRemovable</key>
			<true/>
			<key>Label</key>
			<string>${title}</string>
			<key>PayloadDescription</key>
			<string>Web Clip</string>
			<key>PayloadDisplayName</key>
			<string>${title}</string>
			<key>PayloadIdentifier</key>
			<string>com.apple.webClip.managed.${uuid1}</string>
			<key>PayloadType</key>
			<string>com.apple.webClip.managed</string>
			<key>PayloadUUID</key>
			<string>${uuid1}</string>
			<key>PayloadVersion</key>
			<integer>1</integer>
			<key>URL</key>
			<string>${url}</string>
		</dict>
	</array>
	<key>PayloadDisplayName</key>
	<string>${title}</string>
	<key>PayloadIdentifier</key>
	<string>com.youngunmo.profile.${uuid2}</string>
	<key>PayloadType</key>
	<string>Configuration</string>
	<key>PayloadUUID</key>
	<string>${uuid2}</string>
	<key>PayloadVersion</key>
	<integer>1</integer>
</dict>
</plist>`;

        const blob = new Blob([profile], { type: 'application/x-apple-aspen-config' });
        const link = document.createElement('a');
        link.href = URL.createObjectURL(blob);
        link.download = "youngunmo.mobileconfig";
        link.click();
    }
</script>
</body>
</html>


