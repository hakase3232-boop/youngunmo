<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>앱 설치</title>

    <link rel="manifest" href="/youngunmo/manifest.json">
    <link rel="apple-touch-icon" href="/youngunmo/images/icon-192.png">
    <meta name="theme-color" content="#ffffff">

</head>
<body>
    <h1>앱을 설치해보세요!</h1>
    <p>홈 화면에 바로가기를 추가하면 앱처럼 사용할 수 있습니다.</p>
    
    <button id="installButton" style="display: none;">앱 설치하기</button>

    <script>
        let deferredPrompt; // PWA 설치 이벤트를 저장할 변수

        // 브라우저가 PWA 설치 준비가 되면 발생하는 이벤트
        window.addEventListener('beforeinstallprompt', (e) => {
            // 기본 동작(자동 팝업)을 막고, 이벤트를 변수에 저장
            e.preventDefault();
            deferredPrompt = e;
            
            // '앱 설치하기' 버튼을 표시
            const installButton = document.getElementById('installButton');
            installButton.style.display = 'block';

            // 버튼 클릭 시 PWA 설치 팝업을 띄움
            installButton.addEventListener('click', () => {
                // 저장된 이벤트로 팝업을 띄움
                deferredPrompt.prompt();
                // 사용자가 팝업에 응답하면 버튼을 다시 숨김
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('사용자가 PWA 설치를 승인했습니다.');
                    } else {
                        console.log('사용자가 PWA 설치를 거절했습니다.');
                    }
                    deferredPrompt = null;
                });
            });
        });

        // PWA가 이미 설치되었는지 확인하고, 설치되었다면 버튼을 숨김
        window.addEventListener('appinstalled', () => {
            document.getElementById('installButton').style.display = 'none';
            console.log('PWA가 성공적으로 설치되었습니다.');
        });
    </script>
</body>
</html>








